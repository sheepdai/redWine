<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="icon" href="#">
    <script>
        !function(e,t,i,r){function n(){var e=document.querySelector("head"),t=document.createElement("div");t.style.width="1rem",t.style.display="none",e.appendChild(t);var i=parseFloat(window.getComputedStyle(t,null).width);return e.removeChild(t),i}function a(){var r=d.getBoundingClientRect().width;r/c>768&&(r=768*c);var n=r/e*t;if(!i){var a=p/16;n/=a}d.style.fontSize=n+"px",v.rem=n}var m,o=window,l=o.document,d=l.documentElement,s=l.querySelector('meta[name="viewport"]'),c=0,u=0,p=n(),v={};if(s){var h=s.getAttribute("content").match(/initial\-scale=([\d\.]+)/);h&&(console.warn("将根据已有的meta标签来设置缩放比例"),u=parseFloat(h[1]),c=parseInt(1/u))}if(!c&&!u){var f=o.devicePixelRatio;r?(c=f>=3&&(!c||c>=3)?3:f>=2&&(!c||c>=2)?2:1,u=1/c):(c=1,u=1/c)}if(d.setAttribute("data-dpr",c),!s)if(s=l.createElement("meta"),s.setAttribute("name","viewport"),s.setAttribute("content","width=device-width, initial-scale="+u+", maximum-scale="+u+", minimum-scale="+u+", user-scalable=no"),d.firstElementChild)d.firstElementChild.appendChild(s);else{var w=l.createElement("div");w.appendChild(s),l.write(w.innerHTML)}o.addEventListener("resize",function(){clearTimeout(m),m=setTimeout(a,300)},!1),o.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(m),m=setTimeout(a,300))},!1),a(),v.dpr=c,v.refreshRem=a,v.rem2px=function(e){var t=parseFloat(e)*this.rem;return"string"==typeof e&&e.match(/rem$/)&&(t+="px"),t},v.px2rem=function(e){var t=parseFloat(e)/this.rem;return"string"==typeof e&&e.match(/px$/)&&(t+="rem"),t},window.remmoka=v}
        (750,100,!0,!0);
        /*
        * designWidth, oneRem2Px, resetScaleFontSizeToDefault, useScaleFix1pxTooBold
        * @param designWidth 设计稿宽度 一般来说iPhone6是750 如果缩小就变成了375px
        * @param oneRem2Px 1rem对应多少px
        * @param resetScaleFontSizeToDefault 是否重置Android因为系统放大或者缩小字体带来的影响
        * @param useScaleFix1pxTooBold 是否通过meta标签的scale处理1px过于粗的问题
        * */
    </script>
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <title>首页</title>
</head>

<body class="index">
<div id="page" class="index">
<!--导航-->
<header class="index-header">
    <div class="wrapper">
        <ul class="navigation tabs">
            <li @click="tabId=0" :class="{'active': tabId===0}" class="part recommend">个性推荐</li>
            <li @click="tabId=1" :class="{'active': tabId===1}" class="part strict">严选品牌</li>
            <li @click="tabId=2" :class="{'active': tabId===2}" class="part user">大V用户</li>
        </ul>
    </div>
    <!-- banner图 -->
    <div class="banner swiper-container">
        <ul class="swiper-wrapper">
            <!--<li class="swiper-slide" v-for="item in bannerList">-->
                <!--<img :src="item.wineImg" width="750" height="369">-->
            <!--</li>-->
            <a href="./goods.html?id=5" class="swiper-slide"><img src="./img/index/banner_01.jpg"></a>
            <a href="./goods.html?id=1" class="swiper-slide"><img src="./img/index/banner_02.jpg"></a>
            <a href="./goods.html?id=2" class="swiper-slide"><img src="./img/index/banner_03.jpg"></a>
            <a href="./goods.html?id=3" class="swiper-slide"><img src="./img/index/banner_04.jpg"></a>
            <a href="./goods.html?id=4" class="swiper-slide"><img src="./img/index/banner_05.jpg"></a>
        </ul>
        <!-- 分页器 -->
        <div class="pagination"></div>
    </div>
</header>

<div class="selector-main">


        <!--个性推荐主题内容-->
        <div class="main-body-recommendation" v-show="tabId==0">
            <!--主体导航-->
            <div class="mb-head">
                <div class="mb-head-left">
                    <img src="./img/index/wine_glass.png" width="39" height="56">
                    <a :href="'./ranking_list_collect.html?userId'+this.userId">私人酒窖</a>
                </div>
                <div class="mb-head-border"></div>
                <div class="mb-head-right">
                    <img src="./img/index/hot_list.png" width="54" height="54">
                    <a :href="'./ranking_list.html?userId='+this.userId">热榜</a>
                </div>
            </div>
             <!--推荐酒单-->
             <div class="mb-content">
                    <ul class="mb-content-list">
                        <div class="mb-cl-title">
                            <span>推荐酒单</span>
                            <img src="./img/index/arrows.png">
                        </div>
                        <li class="mb-cl-recommend" v-for="(item,index) in goodsList">
                            <a :href="'./goods.html?userId='+ userId +'&id='+ item.wineId "><img :src="item.wineImg"></a>
                            <div class="mb-cl-recommend-introduction">
                                <!--<span>{{item.wineBrand}}</span>-->
                                <p>{{item.wineName}}</p>
                            </div>
                            <div class="mb-cl-recommend-introduction">
                                <span class="price">￥{{item.winePrice}}</span>
                                <span>评分:{{item.wineScore}}</span>
                            </div>
                        </li>
                    </ul>
                    
                </div>
           
        
            <!-- 好友动态 -->


        </div>




        <!--严选品牌主体内容-->
        <div class="main-body-strict-selection " v-show="tabId==1">
            <!--主体导航-->
            <div class="mb-head tabs_2">
                <div class="mb-head-left mb-head-list" @click="wineId=0" :class="{'active':wineId===0}">
                    <img src="./img/index/red_wine_glass.png">
                    <span>红葡萄酒</span>
                </div>
                <div class="mb-head-border"></div>
                <div class="mb-head-right mb-head-list" @click="wineId=1" :class="{'active':wineId===1}">
                    <img src="./img/index/white_wine_glass.png">
                    <span>白葡萄酒</span>
                </div>
            </div>
            

            <!-- 品牌内容 -->
            <div class="mb-content selector-wine">
                <div class="swiper-wrapper">
                    <!--红葡萄酒品牌-->
                    <div class="red-wine swiper-slide swiper-slide-visible swiper-slide-active stop-swiping" v-show="wineId==0">
                        <div class="mb-content">
                            <ul class="mb-content-list">
                                <div class="mb-cl-title">
                                    <span>推荐酒单</span>
                                    <img src="./img/index/arrows.png">
                                </div>
                                <li class="mb-cl-recommend" v-for="(item,index) in redList">
                                    <a :href="'./goods.html?userId='+ userId +'&id='+ item.wineId "><img :src="item.wineImg"></a>
                                    <div class="mb-cl-recommend-introduction">
                                        <span>{{item.wineBrand}}</span>
                                        <p>{{item.wineName}}</p>
                                    </div>
                                    <div class="mb-cl-recommend-introduction">
                                        <span class="price">￥{{item.winePrice}}</span>
                                    </div>
                                </li>
                            </ul>

                        </div>
                    </div>
                    <!--白葡萄酒品牌-->
                    <div class="white-wine swiper-slide stop-swiping" v-show="wineId==1">
                        <div class="mb-content">
                            <ul class="mb-content-list">
                                <div class="mb-cl-title">
                                    <span>推荐酒单</span>
                                    <img src="./img/index/arrows.png">
                                </div>
                                <li class="mb-cl-recommend" v-for="(item,index) in whiteList">
                                    <a :href="'./goods.html?userId='+ userId +'&id='+ item.wineId "><img :src="item.wineImg"></a>
                                    <div class="mb-cl-recommend-introduction">
                                        <span>{{item.wineBrand}}</span>
                                        <p>{{item.wineName}}</p>
                                    </div>
                                    <div class="mb-cl-recommend-introduction">
                                        <span class="price">￥{{item.winePrice}}</span>
                                    </div>
                                </li>
                            </ul>

                        </div>
                    </div>
                </div>
            </div>
        </div>




        <!--大V用户-->
        <div class="main-body-V" v-show="tabId==2">
            <!--主体导航-->
            <div class="mb-head">
                <div class="mb-head-left">
                    <img src="./img/index/same_city_list.png">
                    <a :href="'./ranking_list_city.html?userId='+this.userId">同城榜</a>
                </div>
                <div class="mb-head-border"></div>
                <div class="mb-head-right">
                    <img src="./img/index/rangking_list.png">
                    <a :href="'./ranking_list_focus.html?userId='+this.userId">排行榜</a>
                </div>
            </div>
            <div class="ranking-list-focus">
                <ul>
                    <li class="section-first-one " v-for="(item,index) in rankList">
                        <a  :href="'./personCenter.html?userId='+item.userId" class="left-image">
                            <img :src="item.userHeadImg" class="king-image">
                        </a>
                        <div class="right-wine-list" >
                            <div class="red-wine-name">
                                <p class="pet-name">{{item.userName}}</p>
                                <span class="num-collect">{{item.userLevel}}</span>级
                                <span class="num-collect">粉丝：{{item.userFansNum}}</span>人
                            </div>
                        </div>
                        <div class="attention"  @click="attention(index)">
                            <span :class="{'active':item.select}">+</span>
                        </div>
                    </li>
                </ul>
            </div>

</div>

<!-- 搜索 -->
<div class="search-button"><a href="./search.html"><img src="./img/index/search_btn.png"></a></div>
<div class="blank"></div>

<!--底部导航-->
<footer>
    <ul class="footer-list">
        <li>
            <a :href="'./index.html?userId'+this.userId"><img src="img/footer/home-y.png" style="width:0.58rem;height:0.52rem"></a>
            <span>首页</span>
        </li>
        <li>
            <a :href="'./shopping_cart.html?userId='+this.userId"><img src="img/footer/shoppingcart.png" style="width:0.58rem;height:0.52rem"></a>
            <span>购物车</span>
        </li>
        <li>
        <a :href="'./personCenter.html?userId='+this.userId"><img src="img/footer/my.png" style="width:0.58rem;height:0.52rem"></a>
        <span>我的</span>
    </li>
    </ul>
</footer>

</div>
</div>
<script src="./js/lib/jquery.min.js"></script>
<script src="./js/lib/idangerous.swiper.min.js"></script>
<script src="./js/lib/vue.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    var instance = axios.create({
    header:{
        contentType: 'application/x-www-form-urlencoded'
    }
})
new Vue({
        el:"#page",
        data:{
            tabId:0,
            wineId:0,
            goodsList:[],
            redList:[],
            whiteList:[],
            rankList:[],
            bannerList:[],
            userId:"oXJnE1Rr36wJ2m_czWkvM8JP3eZU"
        },
        methods:{
            attention:function(index){
                var that = this;
                this.rankList[index].select = true;
                instance({
                    method:"POST",
                    url:"http://dreamjxw.imwork.net:80/jxw/design/attention/check.htm",
                    data:{
                        "userId":that.userId,
                        "attentionId":that.rankList[index].userId
                    },
                    contentType: 'Access-Control-Allow-Origin'
                }).then(function(res){
                    console.log(res.data);
                },function(error){
                    console.log(error);
                })
            }
        },
        mounted () {
            function queryString(key){
                var src = location.search || location.hash,
                        reg = new RegExp('[?&]' + key + '=([^?&=]*)(?=&|$)'),
                        match = reg.exec(src);
                return match == null ? null : decodeURIComponent(match[1]);
            }
            var  userId= queryString('userId');
//            this.userId=userId;
            alert(queryString('userId'));

            var slideshow = $('.banner').swiper ({
                pagination:'.pagination',
                paginationClickable: true,
                speed: 2000,
                loop: true,
                observer:true,
                observeParents:true,
                autoplayDisableOnInteraction : false,
                autoplay:1500
            });
        var that = this;
//        instance({
//            method:"POST",
//            url:"http://dreamjxw.imwork.net:80/jxw/design/recommend/banner.htm",
//            contentType: 'Access-Control-Allow-Origin',
//        }).then(function(res){
//            console.log(res.data);
//            that.bannerList = res.data.data;
//            console.log(res.data.data);
//            var slideshow = $('.banner').swiper ({
//                pagination:'.pagination',
//                paginationClickable: true,
//                speed: 2000,
//                loop: true,
//                observer:true,
//                observeParents:true,
//                autoplayDisableOnInteraction : false,
//                autoplay:1500
//            });
//        },function(error){
//            console.log(error);
//        })

        instance({
                method:"POST",
                url:"http://dreamjxw.imwork.net:80/jxw/design/recommend/recommendWine.htm",
//              data:"oXJnE1Rr36wJ2m_czWkvM8JP3eZU",
                data:that.userId,
                contentType: 'Access-Control-Allow-Origin',
                }).then(function(res){
                    console.log(res.data);
                    that.goodsList = res.data.data;
                    console.log( that.goodsList);
                },function(error){
                    console.log(error);
                });
            instance({
                method:"POST",
                url:"http://dreamjxw.imwork.net:80/jxw/design/selectBrand/redWineBrand.htm",
                contentType: 'Access-Control-Allow-Origin',
            }).then(function(res){
//                console.log(res.data);
                that.redList = res.data.data;
                console.log( that.redList);
            },function(error){
                console.log(error);
            });
            instance({
                method:"POST",
                url:"http://dreamjxw.imwork.net:80/jxw/design/userrank/allRank.htm",
                data:{
//                    "userId":"oXJnE1Rr36wJ2m_czWkvM8JP3eZU"
                    "userId":that.userId
                },
//              data:userId,
                contentType: 'Access-Control-Allow-Origin',
            }).then(function(res){
//                console.log(res.data);
                that.rankList = res.data.data;
                that.rankList.map(function(item){
                    that.$set(item,'select',false);
                })
                console.log( that.rankList);
            },function(error){
                console.log(error);
            });
            instance({
                method:"POST",
                url:"http://dreamjxw.imwork.net:80/jxw/design/selectBrand/whiteWineBrand.htm",
                contentType: 'Access-Control-Allow-Origin',
            }).then(function(res){
                console.log(res.data);
                that.whiteList = res.data.data;
                console.log( that.whiteList);
            },function(error){
                console.log(error);
            })


        }
})
</script>
</body>
</html>